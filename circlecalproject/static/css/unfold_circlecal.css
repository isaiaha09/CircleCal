/* CircleCal admin tweaks for Unfold.
   Uses Unfold theme CSS variables; no hard-coded colors.
*/

/* Overall background: light = white, dark = black. */
body {
  background: #ffffff !important;
}

/* Let the browser pick appropriate native control colors for the active theme.
   This is important for <select> dropdown option menus, which are often OS-rendered.
*/
html:not(.dark) {
  color-scheme: light;
}

html.dark {
  color-scheme: dark;
}

html.dark body {
  background: #000000 !important;
}

/* Light mode: force all text to black (hover rules below still apply). */
html:not(.dark) body,
html:not(.dark) body * {
  color: #000000 !important;
}

/* Keep main admin surfaces aligned with the body background. */
#main,
#nav-sidebar-inner {
  background: #ffffff !important;
}

html.dark #main,
html.dark #nav-sidebar-inner {
  background: #000000 !important;
}

/* Light mode: add a subtle colored divider between sidebar and content. */
html:not(.dark) #nav-sidebar-inner {
  border-right: 1px solid var(--color-primary-400) !important;
}

/* Light mode: make sidebar internal separators a bit more visible. */
html:not(.dark) #nav-sidebar-inner .border-b,
html:not(.dark) #nav-sidebar-inner .border-t,
html:not(.dark) #nav-sidebar-inner hr {
  border-color: var(--color-primary-300) !important;
}

/* Light mode: promote common admin borders to CircleCal blue.
   This matches the actual classes Unfold renders (e.g. border-base-100, border-base-200, border-base-400/10).
*/
html:not(.dark) #main .border-base-100,
html:not(.dark) #main .border-base-200,
html:not(.dark) #main .border-base-400\/10 {
  border-color: var(--color-primary-500) !important;
}

html:not(.dark) #main .border-b.border-base-100,
html:not(.dark) #main .border-t.border-base-100 {
  border-bottom-color: var(--color-primary-500) !important;
  border-top-color: var(--color-primary-500) !important;
}

/* Light mode: make admin index option separators (model rows) very visibly blue.
   Unfold uses utility classes like `border-b border-base-100`, so target those directly.
*/
html:not(.dark) .module table {
  border-color: var(--color-primary-500) !important;
  border-width: 1px !important;
}

html:not(.dark) .module table th.border-b,
html:not(.dark) .module table td.border-b {
  border-bottom-color: var(--color-primary-500) !important;
  border-bottom-width: 1px !important;
}

/* Light mode: make selectable sidebar options look like buttons, not plain links.
   Use outline so it stays visible even with Unfold's negative margins.
*/
html:not(.dark) #nav-sidebar-apps ol.flex.flex-col > li > a {
  background: #ffffff !important;
  outline: 1px solid var(--color-primary-500) !important;
  outline-offset: -1px !important;
}

/* Light mode: the action bar is blue, so keep its text white (override global black rule). */
html:not(.dark) #changelist-actions,
html:not(.dark) #changelist-actions * {
  color: #ffffff !important;
}

/* Dark mode: make the ACTION select dropdown/menu blue with white option text. */
html.dark #changelist-actions select {
  background: var(--color-primary-600) !important;
  color: #ffffff !important;
  border-color: var(--color-primary-800) !important;
}

html.dark #changelist-actions select option {
  background: var(--color-primary-700) !important;
  color: #ffffff !important;
}

html:not(.dark) #nav-sidebar-apps ol.flex.flex-col > li > a:hover {
  background: var(--color-primary-50) !important;
  outline-color: var(--color-primary-800) !important;
}

html:not(.dark) #nav-sidebar-apps ol.flex.flex-col > li > a.active {
  background: var(--color-primary-50) !important;
  outline-color: var(--color-primary-800) !important;
}

/* In dark mode, force ALL text to pure white. */
html.dark body,
html.dark body * {
  color: #ffffff !important;
}

/* ---- Dropdown/readability fixes (native selects + Select2) ----
   The global "force all text" rule can make option text invisible when the OS renders
   the dropdown menu with a light background. Use system colors so contrast is correct
   in BOTH light and dark modes.
*/

/* Native selects (including <option> and <optgroup> menus). */
html body select,
html body select option,
html body select optgroup {
  background-color: Field !important;
  color: FieldText !important;
}

/* Select2 (if enabled on any admin forms/filters). */
html body .select2-container--default .select2-selection--single,
html body .select2-container--default .select2-selection--multiple,
html body .select2-dropdown,
html body .select2-results__option,
html body .select2-search__field,
html body .select2-selection__rendered {
  background-color: Field !important;
  color: FieldText !important;
}

html body .select2-container--default .select2-results__option--highlighted.select2-results__option--selectable {
  background-color: Highlight !important;
  color: HighlightText !important;
}

/* Sidebar “Insights” hover: force CircleCal primary on hover, including nested icon/text. */
#nav-sidebar-apps a:hover,
#nav-sidebar-apps a:hover * {
  color: var(--color-primary-500) !important;
}

/* Also apply to the group header hover (collapsible sections). */
#nav-sidebar-apps h2:hover,
#nav-sidebar-apps h2:hover * {
  color: var(--color-primary-500) !important;
}

/* Generic hover for interactive things: apply to descendants too (so it beats the all-white rule). */
body a:hover,
body a:hover *,
body a:focus-visible,
body a:focus-visible *,
body button:hover,
body button:hover *,
body button:focus-visible,
body button:focus-visible *,
body [role="button"]:hover,
body [role="button"]:hover *,
body [role="button"]:focus-visible,
body [role="button"]:focus-visible * {
  color: var(--color-primary-600) !important;
}

/* On hover/focus, apply primary colors for interactive elements. */
body a:hover,
body a:focus-visible,
body button:hover,
body button:focus-visible,
body [role="button"]:hover,
body [role="button"]:focus-visible {
  color: var(--color-primary-600) !important;
}

body input[type="submit"]:hover,
body input[type="submit"]:focus-visible,
body input[type="button"]:hover,
body input[type="button"]:focus-visible {
  color: var(--color-primary-600) !important;
  border-color: var(--color-primary-500) !important;
}

/* If a button has a border, tint it on hover as well. */
body button:hover,
body button:focus-visible {
  border-color: var(--color-primary-500) !important;
}

/* In dark mode we keep the same rule; the !important makes it override the forced white. */
html.dark body a:hover,
html.dark body a:focus-visible,
html.dark body button:hover,
html.dark body button:focus-visible,
html.dark body [role="button"]:hover,
html.dark body [role="button"]:focus-visible,
html.dark body input[type="submit"]:hover,
html.dark body input[type="submit"]:focus-visible,
html.dark body input[type="button"]:hover,
html.dark body input[type="button"]:focus-visible {
  color: var(--color-primary-500) !important;
}

/* Dashboard KPI tiles: Unfold positions the icon partly outside the card; with overflow hidden it gets clipped.
   Reposition KPI icons fully inside the tile.
*/
.circlecal-kpi-card > .grow.relative {
  padding-left: 4.25rem !important;
}

.circlecal-kpi-card .circlecal-kpi-icon {
  left: 1.25rem !important;
  right: auto !important;
  top: calc(50% + 1.75rem) !important;
  transform: translate(0, -50%) !important;
}

/* Make the + add icons on the admin index use primary color */
#content-main a.addlink {
  color: var(--color-primary-500) !important;
}

.dark #content-main a.addlink {
  color: var(--color-primary-400) !important;
}

/* Make the small + icon a bit more obviously clickable */
#content-main a.addlink:hover {
  color: var(--color-primary-600) !important;
}

.dark #content-main a.addlink:hover {
  color: var(--color-primary-300) !important;
}
